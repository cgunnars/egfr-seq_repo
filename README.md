# EGFR inhibitors + Mtb
This repo contains data and code necessary to reproduce all analyses and graphs for Gunnarsson et al 2025.

# Installing
You can find a list of required Python and R packages in `requirements_python.txt` and `requirements_R.txt`. 

For Python requirements, you can call `pip install -r requirements_python.txt` to install exact package versions, compatible with Python 3.8.3. For R requirements, you can use the package `requiRements` to install the majority of dependencies, but will need to install Bioconductor packages separately.

# Running this repo
All figures, supplementary tables, and supplementary figures have associated `make` targets. 

At a high level, you can call `make figs` from the top-level directory to make figures, `make sfigs` to make supplementary figures, and `make tables` to make supplementary tables. Other interesting make targets include all differential expression comparisons `DE_tables` and clean lux data `clean_lux`. In some cases, we perform manual edits to polish tables and figures for publication, e.g. compiling .csv outputs into a single Excel file, modifying heatmap legend locations and labels, or improving readability. 

# Folder structure
## Data
You can find raw gene expression data in `data/raw_counts` and raw growth data in `data/lux_data`.

External data for chemical properties is in `data/chem_info`, EGFRi pharmacotranscriptomics is in `data/source_data/sci-plex`, and Mtb gene-iModulon mappings are in `data/source_data/imodulon-data`.

## Code
Code lives in `src`, and is in subfolders according to function. 

`src/growth` contains scripts needed to collect TecanSpark plate reads from a given directory, clean data, and plot endpoint results and growth curves, provided standard file naming conventions.

`src/proc` contains scripts needed to collect, clean, and perform differential expression analysis on raw gene expression tsvs. For host data, these assume a standard .rds format, as generated by the zUMIs pipeline. For pathogen data, these assume a .tsv format, as generated by HTSeq, where columns include `sample_NumReads` and `sample_TPM`. We also require a sensible sample naming convention, where metadata is separated by underscores, e.g. `pel_d1_A_1` -> drug day donor replicate.

The `src/old` contains plotting scripts that were used for exploratory analyses, but not pursued as visualizations in the manuscript.
